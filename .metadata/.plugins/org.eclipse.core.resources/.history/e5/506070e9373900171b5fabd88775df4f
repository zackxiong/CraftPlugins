package enterence;

import gui.Gui;
import gui.panels.controlPanel.ResultPanel;

import java.io.File;
import java.io.IOException;
import java.util.Timer;
import java.util.TimerTask;

import org.omg.SendingContext.RunTime;

public class Tester {
	
	String command;
	File file;
	boolean useFile = true;
	Timer timer = new Timer();
	Runtime rt = Runtime.getRuntime();
	
	
	ResultPanel result = new ResultPanel();
	
	public Tester(ResultPanel result){
		this.result = result;
	}
	
	public void useCommand(String command){
		this.command = command;
		this.useFile = true;
	}
	public void useFile(File file){
		this.file = file;
		this.useFile = false;
	}
	
	public void clearCommand(){
		this.command = "";
		this.useFile = true;
	}
	public void clearFile(){
		this.file = null;
	}
	
	public void start(){
		if(useFile){
			if(file == null){
				Gui.log("File not selected!");
				return;
			}
			CommandRunnable runnable = new CommandRunnable(file.getAbsolutePath(), this.rt);
			Thread t = new Thread(runnable);
			this.timer.schedule(new TimerTask() {
		        public void run() {
		            System.out.println("11232");
		        }
			}, 0, 1);\
			t.start();
	}

}

class CommandRunnable implements Runnable{
	boolean isDone = false;
	boolean isError =false;
	String path;
	Runtime rt;
	public CommandRunnable(String path, Runtime rt){
		super();
		this.path = path;
		this.rt = rt;
	}
	@Override
	public void run() {
		try {
			rt.exec(path);
		} catch (IOException e) {
			Gui.displayException(e);
			this.isError = true;
		}
		this.isDone = true;
	}
	
}